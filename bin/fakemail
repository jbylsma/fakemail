#!/bin/bash
set -e

readonly ROOT="/var/log/fakemail"
readonly NAME="$(date "+%Y-%m-%d").txt"
readonly FILE="${ROOT}/${NAME}"

function main {
  if [[ ! -d "${ROOT}" ]]; then
    echo "${ROOT} not found."
    exit 1
  fi

  if [[ ! -f "${FILE}" ]] && ! touch "${FILE}"; then
    echo "Could not create file ${FILE}"
    exit 1
  fi

  if [[ ! -w "${FILE}" ]]; then
    echo "Could not write file ${FILE}"
    exit 1
  fi

  echo -e "----------------------" >> "${FILE}"
  date  >> "${FILE}"
  cat - >> "${FILE}"

}
main "$@"
